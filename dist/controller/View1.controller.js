sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/MessageToast"],function(e,t){"use strict";var a="/sap/opu/odata/sap/ZSD_AMCR_FINTRANSP_SRV/";function r(e,t){var a=e.byId("Header");a.setTitle(t.Exti1.toUpperCase());a.setSubtitle(t.Exti2.toUpperCase());e.byId("carrier").setText(t.Tdlnr.toUpperCase());e.byId("truckPlate").setText(t.Signi.toUpperCase());e.byId("semiPlate").setText(t.Tpbez.toUpperCase());e.byId("executionDate").setText(t.Daten);e.byId("executionHour").setText(t.Uaten)}function s(e,t){var a=e.byId("Header");a.setTitle("");a.setSubtitle("");e.byId("carrier").setText("");e.byId("truckPlate").setText("");e.byId("semiPlate").setText("");e.byId("executionDate").setText("");e.byId("executionHour").setText("")}function o(e,t){e.byId("btnEnd").setVisible(t);e.byId("endLabel").setVisible(t)}function n(e,a,n,i){n.read("/transporteSet(Tknum='"+a+"')",{success:function(a){if(a.Error==="01"){o(e,false);s(e,a);t.show("No existe el transporte")}else{r(e,a);if(a.Daten!==""&&a.Uaten!==""){o(e,false);if(!i){t.show("El transporte ya cuenta con FIN")}}else{o(e,true)}}},error:function(e){t.show("Error obteniendo datos de transportes")}})}function i(e,a,r){var s=true;r.read("/finSet(Transporte='"+a+"')",{success:function(o){if(o.Error==="01"){t.show("Error actualizando transporte")}else{t.show("Transporte actualizado correctamente");n(e,a,r,s)}},error:function(e){t.show("Error actualizando transporte")}})}return e.extend("fin_transporte.fin_transporte.controller.View1",{onInit:function(){var e=this.getView();o(e,false)},onSearch:function(e){if(!e.getParameters().clearButtonPressed){var t=this.getView();var r=this.byId("searchShipment").getValue();var s=false;var o=new sap.ui.model.odata.ODataModel(a,{json:true,loadMetadataAsync:true});n(t,r,o,s)}},onPress:function(){var e=this.getView();var r=this.byId("searchShipment").getValue();var s=new sap.ui.model.odata.ODataModel(a,{json:true,loadMetadataAsync:true});if(r===""){t.show("Transporte vacio");o(e,false)}else{i(e,r,s)}}})});